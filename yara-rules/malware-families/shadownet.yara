private rule ShadowNetCode : ShadowNet Family 
{
    meta:
        description = "ShadowNet code tricks"
        author = "Seth Hardy"
        last_modified = "2014-06-17"
        
    strings:
        // mov ecx, 1DB4h; ??; dec ecx; xor [ecx + edi], ah; cmp ecx, 0;
        $xordecrypt = {B9 B4 1D 00 00 [8] 49 30 24 39 83 F9 00 } 
        
    condition:
        any of them
}

private rule ShadowNetStrings : ShadowNet Family
{
    meta:
        description = "ShadowNet Identifying Strings"
        author = "Seth Hardy"
        last_modified = "2014-06-17"
        
    strings:
        $scriptman = /kernel32\.dll\x00*ScriptMan/
        
    condition:
       any of them
}

rule ShadowNet : Family
{
    meta:
        description = "ShadowNet"
        author = "Seth Hardy"
        last_modified = "2014-06-17"
        
    condition:
        ShadowNetCode or ShadowNetStrings
}